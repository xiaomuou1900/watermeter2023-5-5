<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="hiprint,一个可以跨平台windows,mac,linux运行的js打印插件,打印自动分页">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <title>positionPrint</title>
    <link rel="stylesheet" href="../../layui-v2.7.6/layui/css/layui.css">
    <link href="../Content/hinnn.css" rel="stylesheet" />
    <!-- Bootstrap -->
    <link href="../Content/bootstrap.min.css" rel="stylesheet">
    <link href="../Content/document.css" rel="stylesheet" />
    <!-- HTML5 shim 和 Respond.js 是为了让 IE8 支持 HTML5 元素和媒体查询（media queries）功能 -->
    <!-- 警告：通过 file:// 协议（就是直接将 html 页面拖拽到浏览器中）访问页面时 Respond.js 不起作用 -->
    <!--[if lt IE 9]>
      <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
    <![endif]-->
    <link href="../Content/hinnn.css" rel="stylesheet" />
    <link href="../Content/home.css" rel="stylesheet" />
    <link href="../Content/Font-Awesome-3.2.1/css/font-awesome-ie7.min.css" rel="stylesheet" />
    <link href="../Content/Font-Awesome-3.2.1/css/font-awesome.min.css" rel="stylesheet" />
    <link href="../Content/hiprint/css/hiprint.css" rel="stylesheet" />
    <link href="../Content/hiprint/css/print-lock.css" rel="stylesheet" />
    <!-- <script src="https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script> -->
    <script src="../Content/jquery.js"></script>

    <script data-ad-client="ca-pub-2624961100945767" async
        src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

    <style>
        .layui-input,
        .layui-select {
            height: 28px;
        }
    </style>
</head>

<body>
    <div class="wrapper">
        <layout class="layout hinnn-layout hinnn-layout-has-sider height-100-per" style="background:#fff;">
            <content class="hinnn-layout-content" style="border-left:1px solid #e8e8e8;">
                <div class="container-fluid height-100-per print-content">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="row">
                                <div class="col-sm-3 col-md-2" style="padding-right:0px;">

                                    <div class="rect-printElement-types hiprintEpContainer">
                                        <ul class="hiprint-printElement-type">

                                            <li>
                                                <span class="title"><code>拖拽列表</code></span>
                                                <ul>
                                                    <li>
                                                        <a class="ep-draggable-item" tid="testModule.text" style="">

                                                            <span class="glyphicon glyphicon-text-width"
                                                                aria-hidden="true"></span>
                                                            <span class="glyphicon-class">文本</span>
                                                        </a>
                                                    </li>

                                                    <li>
                                                        <a class="ep-draggable-item" tid="testModule.image" style="">
                                                            <span class="glyphicon glyphicon-picture"
                                                                aria-hidden="true"></span>
                                                            <span class="glyphicon-class">图片</span>
                                                        </a>
                                                    </li>
                                                    <li>
                                                        <a class="ep-draggable-item" tid="testModule.longText">
                                                            <span class="glyphicon glyphicon-subscript"
                                                                aria-hidden="true"></span>
                                                            <span class="glyphicon-class">长文</span>


                                                        </a>
                                                    </li>

                                                    <li>
                                                        <a class="ep-draggable-item" tid="testModule.tableCustom"
                                                            style="">
                                                            <span class="glyphicon glyphicon-th"
                                                                aria-hidden="true"></span>
                                                            <span class="glyphicon-class">表格</span>
                                                        </a>
                                                    </li>

                                                    <li>
                                                        <a class="ep-draggable-item" tid="testModule.html">
                                                            <span class="glyphicon glyphicon-header"
                                                                aria-hidden="true"></span>
                                                            <span class="glyphicon-class">html</span>
                                                        </a>
                                                    </li>

                                                </ul>
                                            </li>
                                            <li>
                                                <span class="title">辅助</span>
                                                <ul>
                                                    <li>
                                                        <a class="ep-draggable-item" tid="testModule.hline" style="">

                                                            <span class="glyphicon glyphicon-resize-horizontal"
                                                                aria-hidden="true"></span>
                                                            <span class="glyphicon-class">横线</span>
                                                        </a>
                                                    </li>

                                                    <li>
                                                        <a class="ep-draggable-item" tid="testModule.vline" style="">
                                                            <span class="glyphicon glyphicon-resize-vertical"
                                                                aria-hidden="true"></span>
                                                            <span class="glyphicon-class">竖线</span>
                                                        </a>
                                                    </li>
                                                    <li>
                                                        <a class="ep-draggable-item" tid="testModule.rect">
                                                            <span class="glyphicon glyphicon-unchecked"
                                                                aria-hidden="true"></span>
                                                            <span class="glyphicon-class">矩形</span>
                                                        </a>
                                                    </li>
                                                    <li>
                                                        <a class="ep-draggable-item" tid="testModule.oval">
                                                            <span class="glyphicon glyphicon-record"
                                                                aria-hidden="true"></span>
                                                            <span class="glyphicon-class">椭圆</span>
                                                        </a>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </div>

                                </div>
                                <div class="col-sm-9 col-md-10">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <div class="hinnn-docs-section">
                                                <h1 class="page-header">票据定位打印</h1>
                                                <p class="simpaleExplain">hiprint
                                                    票据定位打印，用户通过拖拽矩形，椭圆，横线，竖线等来设计票据布局。然后在对应的位置填充文本。操作简单，可视化操作。几分钟时间就可以设计好一个复杂的票据模板。<code>票据定位打印-发票背景需要以PNG格式并以“模板名称”命名存放于lianliwm/sources/img目录下</code>
                                            </div>
                                            <div class="hiprint-toolbar" style="margin-bottom:15px;">
                                                <ul>
                                                    <li style="vertical-align: top;">
                                                        <span>模板名称：</span>
                                                        <form class="layui-form" action="" lay-filter="transferForm"
                                                            style="display: inline-block;">
                                                            <select type="text" id="selcetId"
                                                                lay-filter="select-filter">
                                                            </select>
                                                        </form>
                                                    </li>
                                                    <li>
                                                        <a class="btn hiprint-toolbar-item " style="color: #fff;
    background-color: #d9534f;
    border-color: #d43f3a;" id="bill_preview">快速预览</a>
                                                    </li>
                                                    <li>
                                                        <a class="btn hiprint-toolbar-item " style="color: #fff;
    background-color: #337ab7;
    border-color: #2e6da4;" id="save_template">保存模板</a>
                                                    </li>
                                                    <li>
                                                        <a class="btn hiprint-toolbar-item " style="color: #fff;
    background-color: #d9534f;
    border-color: #d43f3a;" id="bill_print">打印</a>
                                                    </li>

                                                </ul>
                                                <div style="clear:both;"></div>
                                            </div>
                                            <div id="hiprint-printTemplate_bill" class="hiprint-printTemplate">

                                            </div>

                                            <!-- <div class="hinnn-callout hinnn-callout-danger">
                                                <p><code>可视化票据</code>结果以Json的形式存在，用户可以<code>编辑Json</code>实现特殊化操作，如：数据<code>formatter</code>，<code>文本变色</code>,单元格<code>改变背景</code>等。具体请参考文档。
                                                </p>
                                            </div>
                                            <textarea class="form-control" rows="10"
                                                id="textarea_bill">{"panels":[{"index":0,"height":148,"width":210,"paperHeader":-1.5,"paperFooter":380,"printElements":[{"options":{"left":540,"top":10.5,"height":35,"width":33,"borderColor":"#f20000"},"printElementType":{"title":"椭圆","type":"oval"}},{"options":{"left":454.5,"top":15,"height":18,"width":74,"title":"8888888","fontSize":18,"fontWeight":"600","color":"#2935e3","textAlign":"center","lineHeight":16},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":424.5,"top":15,"height":19,"width":24,"title":"NO","fontSize":18,"color":"#2935e3","textAlign":"center","lineHeight":15},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":190.5,"top":15,"height":21,"width":226,"title":"上海增值税普通发票","fontSize":18,"fontWeight":"600","letterSpacing":2.5,"color":"#cc5a5a","textAlign":"center","lineHeight":18},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":244.5,"top":19.5,"height":51,"width":112,"borderColor":"#eb1111","borderWidth":"2"},"printElementType":{"title":"椭圆","type":"oval"}},{"options":{"left":90,"top":19.5,"height":21,"width":96,"title":"8888888","fontSize":19,"letterSpacing":1,"color":"#2935e3","textAlign":"center","lineHeight":18},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":19.5,"top":19.5,"height":61,"width":65,"title":"031001800204","textType":"qrcode"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":250.5,"top":25.5,"height":42,"width":104,"borderColor":"#f00505"},"printElementType":{"title":"椭圆","type":"oval"}},{"options":{"left":190.5,"top":45,"height":10,"width":228,"borderColor":"#b5a8a8"},"printElementType":{"title":"横线","type":"hline"}},{"options":{"left":190.5,"top":49.5,"height":10,"width":228,"borderColor":"#baafaf"},"printElementType":{"title":"横线","type":"hline"}},{"options":{"left":244.5,"top":55.5,"height":22,"width":120,"title":"发票联","fontSize":18,"fontWeight":"600","letterSpacing":8,"color":"#cc5a5a","textAlign":"center","lineHeight":18},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":510,"top":55.5,"height":13,"width":69,"title":"2019年05月09日","color":"#2935e3"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":445.5,"top":55.5,"height":15,"width":57,"title":"开票日期：","color":"#cc5a5a","lineHeight":13},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":90,"top":64.5,"height":15,"width":141,"title":"校验码：123456 788942 52344","color":"#2935e3","textAlign":"center","lineHeight":13},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":400,"top":90,"height":60,"width":10,"borderColor":"#cc5a5a"},"printElementType":{"title":"竖线","type":"vline"}},{"options":{"left":35,"top":90,"height":60,"width":10,"borderColor":"#cc5a5a"},"printElementType":{"title":"竖线","type":"vline"}},{"options":{"left":420,"top":90,"height":61,"width":10,"borderColor":"#cc5a5a"},"printElementType":{"title":"竖线","type":"vline"}},{"options":{"left":10.5,"top":90,"height":282,"width":572,"borderColor":"#cc5a5a"},"printElementType":{"title":"矩形","type":"rect"}},{"options":{"left":405,"top":94.5,"height":55,"width":13,"title":"密码区","fontSize":13,"color":"#cc5a5a","lineHeight":18},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":424.5,"top":94.5,"height":50,"width":152,"title":"","color":"#2935e3"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":15,"top":94.5,"height":53,"width":15,"title":"购买方","fontSize":13,"color":"#cc5a5a","lineHeight":18},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":45,"top":100.5,"height":10,"width":348,"title":"名称：北京地铁税务局有限公司","color":"#2935e3"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":45,"top":115.5,"height":10,"width":347,"title":"纳税人识别号：999999999999999999","color":"#2935e3"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":45,"top":130.5,"height":10,"width":347,"title":"地址、电话：18888888888","color":"#2935e3"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":345,"top":150,"height":190,"width":10,"borderColor":"#cc5a5a"},"printElementType":{"title":"竖线","type":"vline"}},{"options":{"left":409.5,"top":150,"height":190,"width":10,"borderColor":"#cc5a5a"},"printElementType":{"title":"竖线","type":"vline"}},{"options":{"left":295.5,"top":150,"height":190,"width":10,"borderColor":"#cc5a5a"},"printElementType":{"title":"竖线","type":"vline"}},{"options":{"left":480,"top":150,"height":190,"width":10,"borderColor":"#cc5a5a"},"printElementType":{"title":"竖线","type":"vline"}},{"options":{"left":215,"top":150,"height":224,"width":10,"borderColor":"#cc5a5a"},"printElementType":{"title":"竖线","type":"vline"}},{"options":{"left":520.5,"top":150,"height":190,"width":10,"borderColor":"#cc5a5a"},"printElementType":{"title":"竖线","type":"vline"}},{"options":{"left":10,"top":150,"height":10,"width":574,"borderColor":"#cc5a5a"},"printElementType":{"title":"横线","type":"hline"}},{"options":{"left":300,"top":160.5,"height":10,"width":36,"title":"单位","fontSize":13,"color":"#cc5a5a","textAlign":"center"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":349.5,"top":160.5,"height":11,"width":51,"title":"数量","fontSize":13,"color":"#cc5a5a","textAlign":"center"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":225,"top":160.5,"height":10,"width":62,"title":"规格名称","fontSize":13,"color":"#cc5a5a","textAlign":"center"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":420,"top":160.5,"height":10,"width":53,"title":"单价","fontSize":13,"color":"#cc5a5a","textAlign":"center"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":484.5,"top":160.5,"height":10,"width":32,"title":"税率","fontSize":13,"color":"#cc5a5a","textAlign":"center"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":525,"top":160.5,"height":10,"width":52,"title":"税额","fontSize":13,"color":"#cc5a5a","textAlign":"center"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":19.5,"top":160.5,"height":10,"width":184,"title":"货物或应税劳务、服务名称","fontSize":13,"color":"#cc5a5a","textAlign":"center"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":40.5,"top":175.5,"height":12,"width":120,"title":"*餐饮服务*餐费","color":"#2935e3"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":10.5,"top":340.5,"height":10,"width":574,"borderColor":"#cc5a5a"},"printElementType":{"title":"横线","type":"hline"}},{"options":{"left":225,"top":349.5,"height":14,"width":229,"title":"壹佰贰拾元整","color":"#2935e3"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":460.5,"top":349.5,"height":13,"width":58,"title":"（小写）","fontSize":13,"color":"#cc5a5a"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":520.5,"top":349.5,"height":13,"width":48,"title":"￥100.00","color":"#2935e3"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":15,"top":349.5,"height":14,"width":193,"title":"价税合计（大写）","fontSize":13,"color":"#cc5a5a","textAlign":"center"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":300,"top":385.5,"height":10,"width":39,"title":"开票人：","color":"#cc5a5a"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":190.5,"top":385.5,"height":10,"width":103,"title":"轩大可","color":"#2935e3"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":150,"top":385.5,"height":10,"width":33,"title":"复核：","color":"#cc5a5a"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":345,"top":385.5,"height":10,"width":86,"title":"张天天","color":"#2935e3"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":64.5,"top":385.5,"height":10,"width":78,"title":"轩天天","color":"#2935e3"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":439.5,"top":385.5,"height":10,"width":40,"title":"销售方：","color":"#cc5a5a"},"printElementType":{"title":"文本","type":"text"}},{"options":{"left":15,"top":385.5,"height":10,"width":44,"title":"收款人：","color":"#cc5a5a"},"printElementType":{"title":"文本","type":"text"}}],"paperNumberLeft":565.5,"paperNumberTop":394.5,"paperNumberDisabled":true}]}
                                            </textarea> -->

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

            </content>
            <sider class="hinnn-layout-sider" style="">
                <div class="container height-100-per" style="width:250px;">
                    <div class="row">
                        <div class="col-sm-12">
                            <div id="PrintElementOptionSetting" style="margin-top:10px;"></div>
                        </div>
                    </div>
                </div>


            </sider>
        </layout>


        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog modal-lg" role="document" style="display: inline-block; width: auto;">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabel">打印预览</h4>
                    </div>

                    <div class="modal-body">
                        <button type="button" class="btn btn-danger" id="A4_printByHtml">打印</button>
                        <!-- <span id="printerlist"></span> -->
                        <div class="prevViewDiv"></div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>

                    </div>
                </div>
            </div>
        </div>



    </div>


    <!-- jQuery (Bootstrap 的所有 JavaScript 插件都依赖 jQuery，所以必须放在前边) -->

    <!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script> -->
    <script src="../../layui-v2.7.6/layui/layui.js"></script>
    <script src="../Scripts/bootstrap.min.js"></script>
    <script src="../Content/jquery.nicescroll-3.7.4/jquery.nicescroll.min.js"></script>
    <script src="../Content/hiprint/hiprint.bundle.js"></script>


    <script src="../Content/hiprint/custom-etype-provider.js"></script>
    <script src="../Content/hiprint/custom-print-json.js"></script>
    <script src="../Content/hiprint/print-data.js"></script>
    <script src="../Content/hiprint/socket.io.js"></script>
    <script src="../Content/hiprint/polyfill.min.js"></script>
    <script src="../Content/hiprint/plugins/jquery.hiwprint.js"></script>
    <script src="../Content/hiprint/plugins/JsBarcode.all.min.js"></script>
    <script src="../Content/hiprint/plugins/qrcode.js"></script>
    <script src="../Content/hiprint/plugins/jquery.minicolors.min.js"></script>
    <script src="../Content/hiprint/plugins/jspdf/canvas2image.js"></script>
    <script src="../Content/hiprint/plugins/jspdf/canvg.min.js"></script>
    <script src="../Content/hiprint/plugins/jspdf/html2canvas.min.js"></script>
    <script src="../Content/hiprint/plugins/jspdf/jspdf.min.js"></script>
    <script src="../Content/hiprint/socket.io.js"></script>
    <script src="../Content/hiprint/hiprint.config.js"></script>
    <script>
        var hiprintTemplate;
        $(document).ready(function () {
            $(".print-content").niceScroll();
            //初始化打印插件
            hiprint.init({
                providers: [new customElementTypeProvider()]
            });

            //hiprint.PrintElementTypeManager.build('.hiprintEpContainer', 'testModule');
            //设置左侧拖拽事件
            hiprint.PrintElementTypeManager.buildByHtml($('.ep-draggable-item'));

            hiprintTemplate = new hiprint.PrintTemplate({
                template: customPrintJson,
                settingContainer: '#PrintElementOptionSetting',
                paginationContainer: '.hiprint-printPagination'
            });

            //打印设计
            hiprintTemplate.design('#hiprint-printTemplate');

            $('#A4_preview').click(function () {
                $('#myModal .modal-body .prevViewDiv').html(hiprintTemplate.getHtml(printData));
                $('#printerlist').html(createPrintHtml(hiprintTemplate.getPrinterList()));
                $('#myModal').modal('show')
            });

            $('#A4_preview_batch2').click(function () {
                $('#myModal .modal-body .prevViewDiv').html(hiprint.getHtml({ templates: [{ template: hiprintTemplate, data: printData, options: {} }, { template: hiprintTemplate, data: printData }] }));
                $('#printerlist').html(createPrintHtml(hiprintTemplate.getPrinterList()));
                $('#myModal').modal('show')
            });

            $('#A4_directPrint').click(function () {
                hiprintTemplate.print(printData);
            });
            $('#A4_directPrint_batch').click(function () {
                hiprintTemplate.print([printData, printData]);
            });
            $('#A4_directPrint_batch2').click(function () {
                hiprint.print2({ templates: [{ template: hiprintTemplate, data: printData, options: {} }, { template: hiprintTemplate, data: printData }], options: { printer: '', landscape: true } }, function (data) { console.log('success') });

            });

            hiprintTemplate.on('printSuccess', function (data) {
                $('#myModal').modal('hide')
            })
            hiprintTemplate.on('printError', function (data) {

            })
            $('#A4_printByHtml').click(function () {
                hiprintTemplate.print(printData);

                // hiprintTemplate.print2(printData, { printer: $('#printerlist select').val(), title: 'hiprint测试打印'});
            })
            $('#A4_getJson_toTextarea').click(function () {
                // console.log(hiprintTemplate)
                // console.log(hiprintTemplate.getJson())
                $('#A4_textarea_json').val(JSON.stringify(hiprintTemplate.getJson()))
            })

            $('#A4_getJson_toDesign').click(function () {
                hiprintTemplate = new hiprint.PrintTemplate({
                    template: JSON.parse($('#A4_textarea_json').val()),
                    settingContainer: '#PrintElementOptionSetting',
                    paginationContainer: '.hiprint-printPagination'
                });
                $('#hiprint-printTemplate').html('');
                hiprintTemplate.design('#hiprint-printTemplate');
            })
            $('#A4_getHtml_toTextarea').click(function () {
                $('#A4_textarea_html').val(hiprintTemplate.getHtml(printData)[0].outerHTML)
            })
            $('#A4_topdf').click(function () {
                hiprintTemplate.toPdf(printData, '测试导出pdf');
            })
        });

        //调整纸张
        var setPaper = function (paperTypeOrWidth, height) {
            hiprintTemplate.setPaper(paperTypeOrWidth, height);
        }

        //旋转
        var rotatePaper = function () {
            hiprintTemplate.rotatePaper();
        }
        var clearTemplate = function () {
            hiprintTemplate.clear();
        }

        var createPrintHtml = function (printers) {
            var ul = $('<select></select>');
            $.each(printers, function (index, printer) {
                ul.append('<option value="' + printer.name + '" ' + (printer.isDefault ? 'selected' : '') + '>' + printer.name + '</option>');
            })
            return ul;
        }
    </script>

    <script>
        layui.use(['layer'], function () {
            var layer = layui.layer
                , form = layui.form
            $(document).ready(function () {
                var bill_img_url = "url(../../../../sources/img/默认模板.png)"     // 发票背景图地址
                $.ajax({
                    type: 'get'
                    , url: '../../../../api/positionPrint.php'
                    , data: {
                        getData: '获取所有模板名称'
                    }
                    , success: function (res) {
                        $.each(res.templateName, function (index, elem) {
                            var html = '<option value="' + elem + '">' + elem + '</option>'
                            $("#selcetId").append(html)
                        })
                        form.render('select');                              //....渲染所有选择框
                    }
                })
                $.ajax({
                    type: 'get'
                    , url: '../../../../api/positionPrint.php'
                    , data: {
                        getData: '默认模板'
                    }
                    , success: function (res) {
                        customPrintJson = res   //读取模板JSON
                        hiprintTemplate_bill = new hiprint.PrintTemplate({
                            template: customPrintJson,
                            settingContainer: '#PrintElementOptionSetting'
                        });
                        //打印设计
                        // $('#hiprint-printTemplate_bill').html('');
                        hiprintTemplate_bill.design('#hiprint-printTemplate_bill');   //..将模板设置给打印区域
                        $('#hiprint-printTemplate_bill .hiprint-printPaper.hidroppable.design').css("background", bill_img_url)   //设定打印背景
                    }
                })
                form.on('select(select-filter)', function (data) {                 //.....选择查询条件复选框发生改变...//
                    // var elem = data.elem; // 获得 select 原始 DOM 对象
                    var value = data.value; // 获得被选中的值
                    // var othis = data.othis; // 获得 select 元素被替换后的 jQuery 对象 
                    // layer.msg(this.innerHTML + ' 的 value: '+ value); // this 为当前选中 <option> 元素对象
                    $.ajax({                                                //
                        type: 'get'
                        , url: '../../../../api/positionPrint.php'
                        , data: {
                            getData: value
                        }
                        , success: function (res) {
                            customPrintJson = res   //读取模板JSON
                            hiprintTemplate_bill = new hiprint.PrintTemplate({
                                template: customPrintJson,
                                settingContainer: '#PrintElementOptionSetting'
                            });
                            //打印设计
                            $('#hiprint-printTemplate_bill').html('');
                            hiprintTemplate_bill.design('#hiprint-printTemplate_bill');
                            bill_img_url = "url(../../../../sources/img/" + value + ".png)"
                            $('#hiprint-printTemplate_bill .hiprint-printPaper.hidroppable.design').css("background", bill_img_url)   //设定打印背景
                        }
                    })
                });

                $('#bill_preview').click(function () {
                    $('#myModal .modal-body .prevViewDiv').html(hiprintTemplate_bill.getHtml(printData))
                    $('#myModal').modal('show')
                    $('.prevViewDiv').css("background", bill_img_url)   //设定打印背景
                });
                $('#bill_print').click(function () {
                    hiprintTemplate_bill.print(printData);
                });
                $('#save_template').click(function () {         // ...保存模板 按钮
                    $('#textarea_bill').val(JSON.stringify(hiprintTemplate_bill.getJson()))
                    layer.prompt({ title: '新模板名称：' }, function (value, index, elem) {
                        if (value === '') return elem.focus();
                        $.ajax({                                                //
                            type: 'post'
                            , url: '../../../../api/tablePrint.php'
                            , data: {
                                post: '新模板'
                                , templateName: value
                                , templateJson: JSON.stringify(hiprintTemplate_bill.getJson())
                            }
                            , success: function (res) {
                                layer.alert('新模板保存成功')
                            }
                        })
                        // 关闭 prompt
                        layer.close(index);
                    });
                });
            });
        })

    </script>

    <script type="text/javascript">
        $(document).ready(function () {
            $('#barcode_button_preview').click(function () {
                var barCodehiprintTemplate = new hiprint.PrintTemplate({ template: JSON.parse($('#textarea_barcode').val()) });

                var $html = barCodehiprintTemplate.getHtml([{ name: '黄山', barcode: '13234567' }, { name: '黄波', barcode: '1224567' }, { name: '黄磊', barcode: '1234567' }, { name: '黄磊', barcode: '1234567' }, { name: '古丽娜', barcode: '7654321' }])

                $('#myModal .modal-body .prevViewDiv').html($html)
                $('#myModal').modal('show')
            });

            $('#barcode_button_print').click(function () {
                var barCodehiprintTemplate = new hiprint.PrintTemplate({ template: JSON.parse($('#textarea_barcode').val()) });

                var $html = barCodehiprintTemplate.getHtml([{ name: '黄山', barcode: '13234567' }, { name: '黄波', barcode: '1224567' }, { name: '黄磊', barcode: '1234567' }, { name: '黄磊', barcode: '1234567' }, { name: '古丽娜', barcode: '7654321' }])
                barCodehiprintTemplate.printByHtml($html);

            });
        })
    </script>

    <script src="../Content/assets/tctip-1.0.1.min.js"></script>
    <script>
        $(document).ready(function () {
            new tctip({
                top: '20%',
                button: {
                    id: 9,
                    type: 'dashang',
                },
                list: [

                    {
                        type: 'wechat',
                        qrImg: '../Content/assets/weixnpay.jpg'
                    }

                ]
            }).init()

        });
    </script>
</body>

</html>